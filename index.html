<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>æŠ•ç¨¿è©³ç´° | EMO</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;margin:0;background:#0f1115;color:#eaeaea}
  header{padding:14px 16px;background:#111;border-bottom:1px solid #222}
  main{max-width:960px;margin:24px auto;padding:0 16px}
  .card{background:#14171d;border:1px solid #222;border-radius:14px; padding:18px}
  h1{margin:.2em 0 .4em; font-size:22px}
  .meta{color:#9aa0a6;font-size:13px;margin-bottom:10px}
  .img{width:100%;max-height:420px;object-fit:cover;border-radius:12px;border:1px solid #222}
  .reactions{display:grid;grid-template-columns:repeat(6,1fr);gap:8px;margin-top:16px}
  .rx{display:flex;flex-direction:column;align-items:center;gap:4px;padding:10px;border-radius:12px;background:#1a1f27;border:1px solid #222;cursor:pointer;user-select:none}
  .rx small{color:#9aa0a6}
  .rx.active{outline:2px solid #4e8cff}
  .grid{display:grid; grid-template-columns:1.2fr .8fr; gap:18px; margin-top:18px}
  canvas{background:#0f1115;border:1px solid #222;border-radius:12px;padding:8px}
  .legend{display:flex;flex-wrap:wrap;gap:8px; margin-top:8px}
  .pill{padding:6px 10px;border-radius:999px;background:#1a1f27;border:1px solid #222;font-size:12px}
  .cta{margin-top:16px;display:flex;gap:8px}
  .btn{padding:10px 14px;border-radius:10px;border:1px solid #333;background:#1d232f;color:#eaeaea;cursor:pointer}
</style>
</head>
<body>
<header>EMO | æŠ•ç¨¿</header>
<main class="card">
  <h1>è•éº¦æ‰“ã¡ä½“é¨“ @ å°è«¸</h1>
  <div class="meta">æŠ•ç¨¿è€…ï¼š<a href="#">@komoro_soba</a>ãƒ»2025/09/28ãƒ»ã‚«ãƒ†ã‚´ãƒªï¼šä½“é¨“</div>
  <img class="img" src="https://images.unsplash.com/photo-1544511916-0148ccdeb877?q=80&w=1600&auto=format&fit=crop" alt="è•éº¦æ‰“ã¡ä½“é¨“">

  <p>ç²‰ã‹ã‚‰æ‰“ã£ã¦èŒ¹ã§ã‚‹ã¾ã§90åˆ†ã€‚æ„å¤–ã¨ã‚³ãƒ„ãŒã„ã‚‹ãŒã€è¬›å¸«ãŒä¸å¯§ã§å®‰å¿ƒæ„ŸãŒã‚ã£ãŸã€‚é¦™ã‚Šã¯å¼·ã„ãŒå–‰è¶Šã—ã¯è»½ã„ã€‚è¦³å…‰ã¤ã„ã§ã§ã‚‚ååˆ†æ¥½ã—ã‚ã‚‹ã€‚</p>

  <!-- ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
  <div class="reactions" id="reactions">
    <!-- data-key ã¯å›ºå®šï¼šjoy surprise trust interest doubt dislike -->
    <div class="rx" data-key="joy">ğŸ˜Š å–œã³ <small id="c-joy">48</small></div>
    <div class="rx" data-key="surprise">ğŸ˜® é©šã <small id="c-surprise">32</small></div>
    <div class="rx" data-key="trust">ğŸ¤ ä¿¡é ¼ <small id="c-trust">21</small></div>
    <div class="rx" data-key="interest">âœ¨ æœŸå¾… <small id="c-interest">27</small></div>
    <div class="rx" data-key="doubt">ğŸ¤” ç–‘å¿µ <small id="c-doubt">8</small></div>
    <div class="rx" data-key="dislike">ğŸ™… ä¸å¿« <small id="c-dislike">3</small></div>
  </div>

  <div class="grid">
    <div>
      <canvas id="pie"></canvas>
      <div class="legend" id="legend"></div>
    </div>
    <div>
      <div class="pill">ç·ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³æ•°ï¼š<span id="total">139</span></div>
      <div class="pill">ãƒã‚¸ãƒ†ã‚£ãƒ–æŒ‡æ•°ï¼ˆæš«å®šï¼‰ï¼š<span id="pos">+72</span></div>
      <div class="pill">â€œä¿¡é ¼Ã—æœŸå¾…â€ã‚¹ã‚³ã‚¢ï¼š<span id="txi">38</span></div>
      <div class="cta"><button class="btn" id="share">å…±æœ‰</button><button class="btn">é€šå ±</button></div>
    </div>
  </div>
</main>

<script>
  // ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼ˆAPIã§ç½®æ›ã™ã‚‹ï¼‰
  const data = {joy:48,surprise:32,trust:21,interest:27,doubt:8,dislike:3};
  const order = ["joy","surprise","trust","interest","doubt","dislike"];
  const labels = {joy:"å–œã³",surprise:"é©šã",trust:"ä¿¡é ¼",interest:"æœŸå¾…",doubt:"ç–‘å¿µ",dislike:"ä¸å¿«"};

  // åˆè¨ˆ
  const total = Object.values(data).reduce((a,b)=>a+b,0);
  document.getElementById('total').textContent = total;

  // ç°¡æ˜“ã‚¹ã‚³ã‚¢ï¼ˆ+ç³»åˆè¨ˆâˆ’âˆ’ç³»åˆè¨ˆï¼‰
  const pos = (data.joy+data.trust+data.interest) - (data.doubt+data.dislike);
  document.getElementById('pos').textContent = (pos>0?'+':'')+pos;

  document.getElementById('txi').textContent = Math.round((data.trust*data.interest)/total);

  // å††ã‚°ãƒ©ãƒ•
  const ctx = document.getElementById('pie').getContext('2d');
  const pie = new Chart(ctx,{
    type:'pie',
    data:{labels:order.map(k=>labels[k]),datasets:[{data:order.map(k=>data[k])}]},
    options:{
      responsive:true,
      plugins:{legend:{display:false},tooltip:{callbacks:{label:(ctx)=>`${ctx.label}: ${ctx.parsed}ä»¶`}}},
    }
  });

  // å‡¡ä¾‹
  const legend = document.getElementById('legend');
  order.forEach((k,i)=>{
    const pill = document.createElement('div');
    pill.className = 'pill';
    pill.textContent = `${labels[k]}ï¼š${data[k]}`;
    legend.appendChild(pill);
  });

  // ã‚¯ãƒªãƒƒã‚¯ã§æ“¬ä¼¼ã‚¤ãƒ³ã‚¯ãƒªãƒ¡ãƒ³ãƒˆï¼ˆMOCç”¨ï¼‰
  document.querySelectorAll('.rx').forEach(el=>{
    el.addEventListener('click', ()=>{
      document.querySelectorAll('.rx').forEach(x=>x.classList.remove('active'));
      el.classList.add('active');
      const key = el.dataset.key;
      data[key]++; document.getElementById(`c-${key}`).textContent = data[key];
      pie.data.datasets[0].data = order.map(k=>data[k]); pie.update();
      const total2 = Object.values(data).reduce((a,b)=>a+b,0);
      document.getElementById('total').textContent = total2;
      const pos2 = (data.joy+data.trust+data.interest) - (data.doubt+data.dislike);
      document.getElementById('pos').textContent = (pos2>0?'+':'')+pos2;
      document.getElementById('txi').textContent = Math.round((data.trust*data.interest)/total2);
    })
  });

  // å…±æœ‰ï¼ˆãƒ€ãƒŸãƒ¼ï¼‰
  document.getElementById('share').onclick = ()=>alert('å…±æœ‰ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼ˆãƒ€ãƒŸãƒ¼ï¼‰');
</script>
</body>
</html>
